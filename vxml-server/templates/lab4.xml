<?xml version="1.0" encoding="UTF-8"?>
<vxml version="2.1" xmlns="http://www.w3.org/2001/vxml"
      xmlns:voxeo="http://community.voxeo.com/xmlns/vxml">

<!-- Menu -->
<form id="menu">
 <property name="bargein" value="false"/>
  <menu>
     <prompt>
       Hello there! Welcome to the flight booking service. Please choose what to do next.
     <enumerate/>
     </prompt>
     <choice next="#delays"> Information on delayed flights </choice>
     <choice next="#fromcity"> Booking a flight </choice>
     <noinput>
       Please choose one of the next options.
     <enumerate/>
     </noinput>
</menu>
</form>

<form id="delays">
    <prompt>It seems like all flights are on time</prompt>
    <goto next="#menu"/>
</form>


        <form id="flight">
          <field name="flight">
            <grammar src="grammars/lab4.xml#fromcity" type="application/srgs+xml"/>
            <initial name="bypass_initial">
            <prompt>What city are you leaving from?</prompt>
      	     <nomatch count="1">
              Please specify origin, destination and date.
              Say something like "I want to travel from Gothenburg to Seville on June 15th" <reprompt/>
      	     </nomatch>
             <nomatch count="2">
          I'm sorry, I still don't understand.
          I'll ask you for information one piece at a time.
            <assign name="bypass_initial" expr="true"/>
            <reprompt/>
            </nomatch>
            </initial>

            <!-- Origin -->
          <field name="fromcity">
            <grammar src="grammars/lab4.xml#fromcity" type="application/srgs+xml"/>
            <prompt> Where are you going?</prompt>
            <filled>
            <prompt>
            Ok, you said to <value expr="fromcity"/>
            </prompt>
            </filled>
            </field>
      <!-- Destination -->
          <field name="tocity">
            <grammar src="grammars/lab4.xml#tocity" type="application/srgs+xml"/>
            <prompt> Where are you going?</prompt>
            <filled>
      	<prompt>
      	  Ok, you said to <value expr="tocity"/>
      	</prompt>
            </filled>
         </field>

      <!-- Date of departure origin-->
          <field name="alldates">
            <grammar src="grammars/lab4.xml#alldates" type="application/srgs+xml"/>
            <prompt>
      	When do you want to leave?
            </prompt>
              <nomatch>
                <break time="1000" />
      	  Sorry, that date is not among the available options.
      	  <reprompt/>
      	</nomatch>
            <filled>
      	      <prompt>
                Ok, you said on <value expr="alldates"/>
              </prompt>
            </filled>
          </field>
        </form>

      <!-- One way trip -->
          <field name="Oneway" type="boolean">
            <grammar src="grammars/lab4.xml" type="application/srgs+xml"/>
            <prompt>
      	Is it a one way trip?
            </prompt>
          </field>
            <if cond="Oneway==1"/>
            <prompt>
              Excellent.
            </prompt>
              <goto next="#askConfirmOneway"/>
            <else/>
              <goto next="#askReturn"/>
            </if>

        </form>

      <!--Form Confirm one way -->
        <form id="askConfirmOneway">
          <field name="ConfirmOneway" type="boolean">
          <grammar src="grammars/lab4.xml" type="application/srgs+xml"/>
          <filled>
            <prompt>
              Ok, do you want to go from <value expr="fromcity"> to <value expr="tocity"> on <value expr="alldates">?
            </prompt>
          </filled>
             <nomatch>
               <break time="1000" />
      	      Sorry, I didn't hear you.
      	      <reprompt/>
      	     </nomatch>
             <if cond="ConfirmOneway== 0"/>
               <goto next="#fromcity"/>
             <else/>
             <filled>
              <prompt>
              Ok, your flight has been booked from <value expr="fromcity"> to <value expr="tocity"> on <value expr="alldates">. Thank you for using our service.
              </prompt>
             </filled>
             </if>
          </field>
        </form>

      <!-- Form Return date -->
        <form id="askReturn">
          <field name="returndate" type="boolean">
            <grammar src="grammars/lab4.xml" type="application/srgs+xml"/>
            <prompt>
              What date do you want to return?
            </prompt>
             <nomatch>
               <break time="1000" />
               Sorry, that date is not among the available options.
               <reprompt/>
             </nomatch>
           <filled>
            <prompt>
                  Ok, do you want to go from <value expr="fromcity"> to <value expr="tocity"> on <value expr="returndate">?
            </prompt>
          </filled>
          <if cond="returndate== 0"/>
            <goto next="#fromcity"/>
          <else/>
           <prompt>
            Your flight has been booked! Thank you for using our service.
           </prompt>
          </if>
       </field>
       </form>

      <clear/>
      </vxml>
